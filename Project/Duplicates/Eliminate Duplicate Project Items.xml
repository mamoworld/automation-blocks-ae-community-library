<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="68^9@O754pS_kk?;F(Dt">old item</variable><variable id="SC?ZEg`5,^t.~Hvy,7sb">new item</variable><variable id="[CFlFJ7p#^bl*{yo8DG{">temp name</variable><variable id="3l_zkeG==Ab7|{1MjS{R">my layer</variable><variable id="Xw|1t]2ah4Jxd]k?6u/}">original item</variable><variable id="*tMQ{V2c%vB7-=yhBljN">bin</variable><variable id="+T/+@U)*~/][?uYZHW9!">original name</variable><variable id="ty6%VDmBXAX4ee5@W6=[">renamed item</variable></variables><block type="es_tutorial" id="va:.xIH6xuQtDgJ6{opW" x="996" y="10"><field name="WATCH_TUT_LABEL">open web page</field><field name="TITLE">see this forum discussion</field><field name="URL">https://community.adobe.com/t5/after-effects-discussions/consolidate-duplicate-precomps-when-using-quot-duplicates-from-spreadsheet-quot-script-by-automation/m-p/13487431#M221234</field></block><block type="mm_multiline_comment_block" id="lX)GeGLN0%mGmHSxAXfC" x="1516" y="9"><field name="TEXT">Checks if there are any project items&amp;#10;with identical name (and in the same&amp;#10;folder).&amp;#10;&amp;#10;If such duplicate items are found, one&amp;#10;of them is deleted and the other one is&amp;#10;used everywhere instead.&amp;#10;&amp;#10;NOTE: the tool just checks if the names&amp;#10;of the items are identical, not if their&amp;#10;content is identical. If you have&amp;#10;project items with identical name (and&amp;#10;inside the same bin), but with different&amp;#10;content, the tool will still delete one&amp;#10;of them.</field></block><block type="variables_set" id="s|kVO#}0=mErggw4.s`E" x="1011" y="503"><field name="VAR" id="[CFlFJ7p#^bl*{yo8DG{">temp name</field><comment pinned="false" h="80" w="160">the tool looks for duplicates by
1. renaming project items one by one
2. after renaming an item, checking if there still exists an item with the original name.
Hence, make sure no project item exists in your project with this name.</comment><value name="VALUE"><block type="text" id="FniuvOPIP3Jmi}[i2+FW"><field name="TEXT">no project item should have this name</field></block></value><next><block type="block_ae_for_all_items_in_bin" id="-|5YJ?wj{i|kc|JcC:VE"><field name="ITEM_VARIABLE" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field><field name="USE_SUBBINS">BIN_AND_SUBBINS</field><field name="FootageNoSolidItem">TRUE</field><field name="CompItem">TRUE</field><field name="SolidItem">FALSE</field><field name="FolderItem">FALSE</field><value name="PARENT_BIN"><shadow type="ae_itembin_path" id="FG#0d]KEYDPCfFfG,+ne"><field name="ITEM_PATH"></field></shadow></value><value name="ONLY_SELECTED"><shadow type="block_checkbox" id="r1G!cB=Bl+Z*_,US`M$0"><field name="VALUE">FALSE</field></shadow></value><statement name="LOOP_STATEMENT"><block type="variables_set" id="Og~J@0Z^4J6ytGTC.duy"><field name="VAR" id="*tMQ{V2c%vB7-=yhBljN">bin</field><value name="VALUE"><block type="ae_item_get_attribute" id="q)kk=R]KOi7W`70`Q.s#"><field name="PARAM">PARENT_BIN</field><value name="ITEM"><shadow type="ae_item_path" id="(2}tgxr%6oN5vY%}7A@G"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="r7u+9z5E!C`vWxljYDrL"><field name="VAR" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field></block></value></block></value><next><block type="variables_set" id="]QZ[_av}j3~!|s#!)4Qf"><field name="VAR" id="+T/+@U)*~/][?uYZHW9!">original name</field><value name="VALUE"><block type="ae_item_get_attribute" id="vlY!.ae[u})vp;Q9kAuR"><field name="PARAM">NAME</field><value name="ITEM"><shadow type="ae_item_path"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="Jvqb`XG@@Nwjss.VJUVy"><field name="VAR" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field></block></value></block></value><next><block type="ae_item_set_attribute" id="Aq+G`he/5obH(-k3z)jq"><field name="PARAM">NAME</field><value name="ITEM"><shadow type="ae_item_path" id="5Fq7dm+:3H^K#j$xWjzg"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="jCR[)@en32(ZSKRs^^a?"><field name="VAR" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field></block></value><value name="VALUE"><shadow type="text" id="LyB~t{LEA6+.]?clne]N"><field name="TEXT"></field></shadow><block type="variables_get" id="LFM.Rl+vG.%cV2863Crh"><field name="VAR" id="[CFlFJ7p#^bl*{yo8DG{">temp name</field></block></value><next><block type="variables_set" id="hXv%5;GIRGKhA=%^=~*8"><field name="VAR" id="ty6%VDmBXAX4ee5@W6=[">renamed item</field><value name="VALUE"><block type="text_join" id="xQo^J$|9#rK)`VE?C)jg"><mutation items="3"></mutation><value name="ADD0"><block type="variables_get" id="lbMF1^X*sI1CC3J)4q~K"><field name="VAR" id="*tMQ{V2c%vB7-=yhBljN">bin</field></block></value><value name="ADD1"><block type="text" id="x+y93)!Y2Z-HYRgj1|:#"><field name="TEXT">/</field></block></value><value name="ADD2"><block type="variables_get" id="IrV$bHz#yA+Sj-(I%}B3"><field name="VAR" id="[CFlFJ7p#^bl*{yo8DG{">temp name</field></block></value></block></value><next><block type="controls_if" id="nPJWePc5l1mi3]Mh:]s8"><mutation else="1"></mutation><comment pinned="false" h="80" w="160">if the original item still exists, it means that we had two items with exactly the same name (otherwise another item with that name in the same bin would not exist anymore after renaming)</comment><value name="IF0"><block type="ae_item_exists" id="ieKCkys-O*6(5Jt`~lS*"><value name="ITEM"><shadow type="ae_item_path" id="2%@1zFhuI/9AkdPN*!cb"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="ZtVq,X*O0$},$`sscR{|"><field name="VAR" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field></block></value></block></value><statement name="DO0"><block type="procedures_callnoreturn" id="Uqee:I4R8:);]@Yet(Y-"><mutation name="replace project item by other one"><arg name="old item"></arg><arg name="new item"></arg></mutation><value name="ARG0"><block type="variables_get" id="MJS0g`Mi`1TzGcZS8cO9"><field name="VAR" id="ty6%VDmBXAX4ee5@W6=[">renamed item</field></block></value><value name="ARG1"><block type="variables_get" id="U=ndhp|y4Y:xr98g^27H"><field name="VAR" id="Xw|1t]2ah4Jxd]k?6u/}">original item</field></block></value></block></statement><statement name="ELSE"><block type="ae_item_set_attribute" id=";D*I|Z?04V7Y=xFx9L5h"><field name="PARAM">NAME</field><comment pinned="false" h="80" w="160">this item had no duplicate --&gt; hence just go back to the original name</comment><value name="ITEM"><shadow type="ae_item_path"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="3G(ERok-MPJa|F,Z^t[C"><field name="VAR" id="ty6%VDmBXAX4ee5@W6=[">renamed item</field></block></value><value name="VALUE"><shadow type="text"><field name="TEXT"></field></shadow><block type="variables_get" id="kFJ`yA6]B_ehRI%H(1-B"><field name="VAR" id="+T/+@U)*~/][?uYZHW9!">original name</field></block></value></block></statement></block></next></block></next></block></next></block></next></block></statement></block></next></block><block type="procedures_defnoreturn" id="3udaWe;rg;FH*VPiPgrF" x="1977" y="1189"><mutation><arg name="old item" varid="68^9@O754pS_kk?;F(Dt"></arg><arg name="new item" varid="SC?ZEg`5,^t.~Hvy,7sb"></arg></mutation><field name="NAME">replace project item by other one</field><comment pinned="false" h="80" w="160">deletes the old item from the project and uses the new item instead everywhere where the old item was used</comment><statement name="STACK"><block type="block_ae_for_all_layers_with_source_item" id="ZX{c40Ix{|6_U*Yp?r3T"><field name="LAYER_VARIABLE" id="3l_zkeG==Ab7|{1MjS{R">my layer</field><comment pinned="false" h="80" w="160">any layer that uses the old item should use the new item instead</comment><value name="SOURCE_ITEM"><shadow type="ae_item_path" id="y!vI6s[5JnCveWzA!u82"><field name="ITEM_PATH">click refresh icon to choose selected project item</field></shadow><block type="variables_get" id="Af69YQUlb0.YkAtsFh+a"><field name="VAR" id="68^9@O754pS_kk?;F(Dt">old item</field></block></value><statement name="LOOP_STATEMENT"><block type="ae_layer_set_attribute" id="ke|*80F#{N27H/Ebue1M"><field name="PARAM">SOURCE</field><value name="ITEM"><block type="variables_get" id="3i?hvbsuHD^(Y_;:qg-S"><field name="VAR" id="3l_zkeG==Ab7|{1MjS{R">my layer</field></block></value><value name="VALUE"><shadow type="text" id=":}pz[NQ[0@c0u/?[`-(K"><field name="TEXT">path or name of project item</field></shadow><block type="variables_get" id="6/H:oBR4R4Pm$3.2OSnd"><field name="VAR" id="SC?ZEg`5,^t.~Hvy,7sb">new item</field></block></value></block></statement><next><block type="block_ae_item_delete" id="s|v*L2C|Zjjf_zv_gC?,"><value name="ITEM"><block type="variables_get" id="J5~~^WZ-7.NhJODF:e31"><field name="VAR" id="68^9@O754pS_kk?;F(Dt">old item</field></block></value></block></next></block></statement></block></xml>